---
title: "Reproducible Figures Assignment"
output:
  html_document: default
  pdf_document: default
date: "2023-11-29"
---

# Installing and loading packages

```{r echo=FALSE}
library(tidyverse)
library(palmerpenguins)
library(janitor)
library(here)
library(ggplot2)
library(patchwork)
library(ragg)
library(svglite)

source(here("functions","cleaning_penguin_data.r"))
```

# Data Preparation:

```{r echo=FALSE}
#Preserving and loading raw data.

write.csv(penguins_raw, here("data","penguins_raw.csv"))
penguins_data_raw<-read.csv(here("data","penguins_raw.csv"))


#Investigating data

head(penguins_data_raw)
colnames(penguins_data_raw)


#Cleaning raw data to generate a cleaner dataset.

cleaning_penguin_columns <- function(raw_data){
    raw_data %>% 
    clean_names() %>% 
    shorten_species() %>% 
      remove_empty(c("rows", "cols")) %>% 
      select(-starts_with("delta")) %>% 
      select(-comments)}
      
colnames(penguins_data_raw)
penguins_data_clean<-cleaning_penguin_columns(penguins_data_raw)
colnames(penguins_data_clean)

#writes new csv for clean penguins data. 
write.csv(penguins_data_clean, here("data","penguins_data_clean.csv"))
```

## QUESTION 1: Data Visualisation for Science Communication

### a) Create a figure using the Palmer Penguin dataset that is correct but badly communicates the data. Do not make a boxplot.

```{r bad figure code, echo=FALSE}
bad_bargraph_island_png<-ggplot(penguins_data_clean) + geom_col(aes(x=island, y=body_mass_g))

ggplot(penguins_data_clean) + geom_col(aes(x=island, y=body_mass_g))

agg_png("figures/bad_bargraph_island_bodymass.png", 
        width = 20,
        height = 20,
        units = "cm",
        res = 200,
        scaling = 0.5)

print(bad_bargraph_island_png)
dev.off()

bad_bargraph_clutch_png<-ggplot(penguins_data_clean) + geom_col(aes(x=clutch_completion, y=body_mass_g))

agg_png("figures/bad_bargraph_clutch_bodymass.png", 
        width = 20,
        height = 20,
        units = "cm",
        res = 200,
        scaling = 0.5)

print(bad_bargraph_clutch_png)
dev.off()

bad_scatterplot_png<-ggplot(penguins_data_clean, aes(x=body_mass_g, y=culmen_length_mm)) + geom_point()

agg_png("figures/bad_scatterplot_bodymass_culmenlength.png", 
        width = 20,
        height = 20,
        units = "cm",
        res = 200,
        scaling = 0.5)

print(bad_scatterplot_png)
dev.off()

ggplot(penguins_data_clean) + geom_col(aes(x=island, y=body_mass_g, color=species))

island_bm_anova <- aov(body_mass_g ~ island + species, data=penguins_data_clean)
summary(island_bm_anova)
```

### b) Write about how your design choices mislead the reader about the underlying data (200-300 words). Include references.

My graph is correct but some design choices mislead the reader.

To start with, there is no information about each data point, such as the species of penguin each sample is a member of. This is misleading as species of penguin is likely to be a confounding variable which impacts both size of penguin and the island it inhabits, as different species have different ranges. This therefore may mislead a reader as the effects of different species are not shown, and so a misleading correlation may be represented on my graph. 

Also, the axis labels edited in the .png plot are subpar, failing to properly explain the contents of the graph. For example, the y-axis label only states “body_mass_g”, but the information contained in this graph is actually the maximum body mass recorded on each island. 

Moreover, axis labels are also very small, which makes it hard for a reader to understand what is being shown by the graph. Readers will have to look very closely at the axis labels to see the variables being compared. This can be argued as misleading because by not clearly showing your axis labels and any units associated with them, readers are made more likely to miss key details about exactly what is being compared or what relationship is being suggested by a graph between two variables, which may cause them to believe a correlation is present which may actually not be.

The lack of error bars may also be considered misleading as it is unclear to a reader how much measurements for a certain treatment (in this case each island) vary and so precise and accurate the data are. It is unclear whether the samples taken from each island are representative of the population on each island or whether there is wide variation and improper sampling.


## Question 2

### Introduction

```{r Data Exploration- taken from lesson materials provided by Lydia France, University of Oxford, 2024}
library(palmerpenguins)

write.csv(penguins_raw, here("data","penguins_raw.csv"))
penguins_data_raw<-read.csv(here("data","penguins_raw.csv"))


#Investigating data

head(penguins_data_raw)
colnames(penguins_data_raw)


#Cleaning raw data to generate a cleaner dataset.

cleaning_penguin_columns <- function(raw_data){
    raw_data %>% 
    clean_names() %>% 
    shorten_species() %>% 
      remove_empty(c("rows", "cols")) %>% 
      select(-starts_with("delta")) %>% 
      select(-comments)}
      
colnames(penguins_data_raw)
penguins_data_clean<-cleaning_penguin_columns(penguins_data_raw)
colnames(penguins_data_clean)

#writes new csv for clean penguins data. 
write.csv(penguins_data_clean, here("data","penguins_data_clean.csv"))


```

```

### Hypothesis

### Statistical Methods

```{r Statistics}

# Make sure your code prints. 

```

### Results & Discussion

```{r Plotting Results}

# Make sure your code prints. 

```

### Conclusion

*You will be marked on the following:*

a)  Your code for readability and functionality
b)  Your figures for communication
c)  Your text communication of your analysis

## QUESTION 3: Open Science

### a) GitHub

*Upload your RProject you created for **Question 2** and any files and subfolders used to GitHub. Do not include any identifiers such as your name. Make sure your GitHub repo is public.*

*GitHub link:*

*You will be marked on your repo organisation and readability.*

### b) Share your repo with a partner, download, and try to run their data pipeline.

*Partner's GitHub link:*

*You **must** provide this so I can verify there is no plagiarism between you and your partner.*

### c) Reflect on your experience running their code. (300-500 words)

-   *What elements of your partner's code helped you to understand their data pipeline?*

-   *Did it run? Did you need to fix anything?*

-   *What suggestions would you make for improving their code to make it more understandable or reproducible, and why?*

-   *If you needed to alter your partner's figure using their code, do you think that would be easy or difficult, and why?*

### d) Reflect on your own code based on your experience with your partner's code and their review of yours. (300-500 words)

-   *What improvements did they suggest, and do you agree?*

-   *What did you learn about writing code for other people?*
